<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/> 
    <title>Web Console in Firefox 4</title>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.2/jquery.min.js"></script>
    <script>
      $(document).ready(function() {
        var counts = {
          bugs: 0,
          commit: 0,
          approval: 0,
          waiting: 0,
          review: 0,
          patch: 0,
          test: 0,
          blocker: 0,
          nom: 0
        };
        $(".bug").each(function(index, elem) {
          var bugNumber = elem.innerHTML;
          var lastSpace = bugNumber.lastIndexOf(" ");
          if (lastSpace > -1) {
            bugNumber = bugNumber.substring(lastSpace + 1);
          }
          elem.setAttribute("href", "https://bugzilla.mozilla.org/show_bug.cgi?id=" + bugNumber);
          elem.setAttribute("target", "_blank");
          var classlist = elem.classList;
          counts.bugs++;
          if (classlist.contains("commit")) {
            counts.commit++;
          }
          if (classlist.contains("approval")) {
            counts.approval++;
          }
          if (classlist.contains("waiting")) {
            counts.waiting++;
          }
          if (classlist.contains("review")) {
            counts.review++;
          }
          if (classlist.contains("patch")) {
            counts.patch++;
          }
          if (classlist.contains("blocker")) {
            counts.blocker++;
          }
          if (classlist.contains("nom")) {
            counts.nom++;
          }
          if (classlist.contains("test")) {
            counts.test++;
          }
        });
        for (var key in counts) {
          $('#counts_' + key).html(counts[key]);
        }
        $("#counts_notstarted").html(counts.bugs - counts.review - counts.commit - counts.patch - counts.waiting);
      });
    </script>
    <link type="text/css" rel="stylesheet" href="styles.css">
    <style>
      .bug {
        color: #c22;
      }
      
      .blocker {
        color: #c22;
        font-weight: bold;
      }
      
      .patch, .review, .waiting {
        color: #272;
      }
      
      .approval, .commit {
        color: #2c2;
      }
      
      #counts_table td {
        text-align: right;
      }
    </style>
  </head>
  <body>
    <h1>Firefox 4 Web Console Completion Status</h1>
    <p><a href="http://scr.im/kdangoor">kdangoor</a>, December 15, 2010</p>
    <h2>Overview</h2>
    <p>The Web Console feature in Firefox 4 is an important tool for developers. This document is intended to make it easy to understand the work that remains for the Web Console.</p>
    <p>The current draft documentation for the Web Console feature is <a href="https://developer.mozilla.org/en/Using_the_Web_Console">up on MDC</a>.</p>
    <p>If you find any errors in this document, please <a href="http://scr.im/kdangoor">email me</a> or <a href="http://github.com/mozilla/devtools">fork this project on GitHub</a>.
    Make sure you're working in the gh-pages branch.</p>
    <p>The numerical picture of Web Console bugs:</p>
    <table id="counts_table">
      <tbody>
        <tr>
          <th>Total bugs in plan for Firefox 4</th><td id="counts_bugs"></td>
        </tr>
        <tr>
          <th>Blockers (in the total)</th><td id="counts_blocker"></td>
        </tr>
        <tr>
          <th>Blocker nominations</th><td id="counts_nom"></td>
        </tr>
        <tr>
          <th>Bugs that are not yet started</th><td id="counts_notstarted"></td>
        <tr>
          <th>Ready to commit!</th><td id="counts_commit"></td>
        </tr>
        <tr>
          <th>Needs approval</th><td id="counts_approval"></td>
        </tr>
        <tr>
          <th>Up for review</th><td id="counts_review"></td>
        </tr>
        <tr>
          <th>Has a patch</th><td id="counts_patch"></td>
        </tr>
        <tr>
          <th>Fixed by other bugs</th><td id="counts_waiting"></td>
        </tr>
      </tbody>
    </table>
    
    <p>Bug key:</p>
    <ul>
      <li class="blocker">Blocker without patches</li>
      <li class="commit">Ready to commit</li>
      <li class="review">Progressing</li>
      <li style="color: #c22">Other bug without patches</li>
    </ul>
    
    <h2>UI Polish</h2>
    <p>The Web Console is useful today, but visual changes will go a long way toward making the Web Console look great and be even more usable.</p>
    <div class="image">
      <img src="images/TheConsole.png" width="800">
      <div>Web Console, 10/1</div>
    </div>
    <div class="image">
      <img src="https://bug605621.bugzilla.mozilla.org/attachment.cgi?id=487101" width="800">
      <div>Work-in-progress screenshot, 10/29</div>
    </div>
    <div class="image">
      <img src="images/NetworkInspector.png">
      <div>Network Inspector, 10/1</div>
    </div>
    <div class="image">
      <img src="https://bug603625.bugzilla.mozilla.org/attachment.cgi?id=488169">
      <div>Network Inspector with bug 603625 patch applied</div>
    </div>
    <p>The toolbar reformatting is particularly important, because it makes the filtering a lot more usable.</p>
    <p>Open UI polish bugs:</p>
    <ul>
      <li><a class="bug patch blocker p1">bug 605621</a> Web Console output box should be reskinned (ready to commit code, CSS needs review, 12/14)
      <ul>
        <li><a class="bug waiting blocker p1">bug 588379</a> Errors in the Web Console should link to the source file (waiting on bug 605621)</li>
        <li><a class="bug waiting blocker p1">bug 603005</a> HUDService should avoid the use of DOM mutation event listeners (waiting on bug 605621)</li>
        <li><a class="bug waiting p2">bug 604618</a> Area outside the network traffic messages should not trigger the "Inspect Network Request" window on mouse click event (waiting on bug 605621)</li>
        <li><a class="bug blocker p1 waiting">bug 601196</a> Console styling busted by personas (fixed by bug 605621, 12/13)</li>
        <li><a class="bug waiting p2">bug 592309</a> Web Console should use &lt;description> elements instead of &lt;label> elements for its output</li>
      </ul>
      </li>
      <li><a class="bug patch p1">bug 603625</a> Network panel heading realignment (has feedback, needs to move to review)</li>
      <li><a class="bug commit blocker p1">bug 598357</a> change command line output to be easier to understand (ready to commit as of 12/10)</li>
      <li><a class="bug p1">bug 609372</a> better icons for the web console (expected somewhere around 12/22)</li>
      <li><a class="bug patch p2">bug 611440</a> Smart abbreviation for URLs in the Web Console (this would be awesome!)</li>
      <li><a class="bug p2">bug 611795</a> Repeated messages in the Web Console should be collapsed into one</li>
      <li><a class="bug patch p2">bug 612252</a> "clear console" needs a keyboard shortcut in a bad way</li>
      <li><a class="bug waiting p2">bug 612253</a> Need a shortcut key to focus the input line in web console</li>
      <li><a class="bug p3">bug 613925</a> Console shrinks tab's thumbnail height in win7 taskbar</li>.
      <li><a class="bug blocker patch p1">bug 613642</a> Web Console is hard to use with polling XMLHttpRequests (up for review on 12/14)</li>
      <li><a class="bug p1">bug 614784</a> Themes are breaking web console's UI</li>
      <li><a class="bug nom waiting p1">bug 615791</a> Web console doesn't support high contrast mode on Windows (waiting on 605621)</li>
      <li><a class="bug p2">bug 615805</a> Resizing Inspect Network Request window causes window to move (new on 11/30)</li>
      <li><a class="bug commit p3">bug 618889</a> Web Console doesn't animate away when you click the close button (ready for commit, 12/14)</li>
      <li><a class="bug p1">bug 618322</a> Inspect pop-up should have scroll bars and be wider</li>
      <li><a class="bug p3">bug 618413</a> Web Console shows garbled IDN address of a file with an exception (when using Privoxy)</li>
    </ul>
    
    <h2>Logging Functionality</h2>
    <p>There are two big areas in which we are improving message logging. This improved logging will also help Firebug.</p>
    <ul>
      <li>Many more messages will be associated directly with the window/tab for which they are relevant. The Web Console and Firebug have been using heuristics to join messages with their windows for these to date, rather than explicit data. The end result for the user will be a much better experience in finding errors in their code.</li>
      <li>The lazy console service will allow logging of messages before the console is opened. Specifically, any messages sent to the console API (console.log, for example) or any CSS and JavaScript errors will be cached for display when the user opens the Web Console. Network traffic logging will <em>not</em> be cached before the console is opened.</li>
    </ul>
    <p>Open logging functionality bugs:</p>
    <ul>
      <li><a class="bug patch blocker p1">bug 612658</a> Implement ConsoleStorageService (waiting on new patch since 12/12)
        <ul>
          <li><a class="bug patch blocker p1">bug 611032</a> Break out HUDConsoleObserver from HUDService</li>
          <li><a class="bug patch blocker p1">bug 609890</a> display cached console messages when the user opens the console (waiting on new patch since 12/8)</li>
          <li><a class="bug p1">bug 616318</a> Cache all messages that are logged after UI is shown</li>
        </ul>
      </li>
      <li><a class="bug review blocker p1">bug 606498</a> log messages with associated window using nsiScriptError2 (r- on 12/7)
        <ul>
          <li><a class="bug commit p2">bug 603750</a> nsWebSocket connection failure messages do not show in the Web Console (waiting on 606498 to land)</li>
          <li><a class="bug commit blocker p1">bug 603706</a> Need a way to track the originating window for all nsIConsoleMessages (waiting on bug 611789?)</li>
          <li><a class="bug patch blocker p3">bug 611789</a> Web Console cleanup: Remove the window registry (has feedback+, waiting on new feedback 12/9, needs window ID bugs to land)
            <ul>
              <li><a class="bug waiting p1">bug 594523</a> When tab location changes, the HUDService fails to clear/update state information
                <ul>
                  <li><a class="bug patch blocker p1">bug 595223</a> log loading from file:// urls (might be superseded by bug 594523? asked for status on 12/1)</li>
                </ul>
              </li>
            </ul>
          </li>
        </ul>
      </li>
      <li><a class="bug p3 patch">616586</a> Internal console logging API for use in JSMs and Components</li>
      <li><a class="bug p2">616742</a> citytv website breaks with the way it accesses the console</li>
      <li><a class="bug p1 nom">bug 618334</a> normal GET requests should show up under Net/Log, not Net/Error</li>
    </ul>
    
    <h2>JavaScript Console</h2>
    <p>These are improvements we want to make to the JavaScript command line:</p>
    <ul>
      <li><a class="bug p3">bug 614586</a> Implement string substitution in all console API methods</li>
      <li><a class="bug p2">bug 618344</a> Web Console pprint() command should display something useful for functions</li>
    </ul>
    
    <h2>Other bugs</h2>
    <p>Yep, there are some other random things we're fixing up as well.</p>
    <ul>
      <li><a class="bug patch p2">bug 599725</a> Web Console reports data the server did not send (304 not modified) - shows headers from the cache, not headers from the server (new patch on 12/1, awaiting feedback)</li>
      <li><a class="bug waiting p1">bug 601126</a> Time elapsed in console log doesn't always match time in net request inspector (waiting on doc)</li>
      <li><a class="bug waiting p3">bug 598438</a> window.console and window.onerror fail to work in iframes on first Web Console open (looks to be test only, 12/1)</li>
      <li><a class="bug patch blocker p1">bug 602572</a> Log request and response bodies checkbox issues in Web Console (final blocker, <b>needs review since 11/17</b>)</li>
      <li><a class="bug blocker p1">bug 606055</a> Memory leaks on google.com with the Web Console open (might be fixed by bug 599725. needs to be checked. 12/2)</li>
      <li><a class="bug nom p1">bug 613364</a> javascript strict errors do not use the property when creating a log message (no action since 11/18)</li>
      <li><a class="bug patch nom p2">bug 613280</a> Cannot copy result text in console (f+ on 11/29, needs review set)</li>
      <li><a class="bug p1">bug 609744</a> Make the web console control-e terminal keybinding play nicely with Panorama (not assigned, no action since 11/04)</li>
      <li><a class="bug p3">bug 614802</a> Entering heavy content(text) in command line breaks the web console</li>
      <li><a class="bug waiting p1">bug 614793</a> Web console window should automatically scroll to display results (waiting on 613642)</li>
      <li><a class="bug p2">bug 615408</a> Web Console gets stuck at 0px height w/ border and keyboard shortcut breaks</li>
      <li><a class="bug p2">bug 617322</a> Enlarge the selection area of text in the web console</li>
      <li><a class="bug p1">bug 618311</a> network request window stays open when switching to private browsing (data leak)</li>
    </ul>
    
    <h2>Error Console</h2>
    <p>Our old friend the Error Console is being hidden away, since most web developers will get everything they need out of the Web Console. We have a little bit of work left to do to hide the error console.</p>
    <ul>
      <li><a class="bug review blocker p2">bug 593540</a> Don't display content errors in the Error Console (has patches with test, some reviewed on 11/30)</li>
      <li><a class="bug commit blocker p1">bug 602006</a> disable Error Console again once Web Console improvements land (ready to check in, 11/30)</li>
    </ul>
    
    <h2>Cleanup/Tests</h2>
    <p>We have some bugs that are not functionality-related but are important bits of cleanup.</p>
    <ul>
      <li><a class="bug p3">bug 592469</a> Web Console cleanup: kill getHeadsUpDisplay()</li>
      <li><a class="bug p2">bug 603001</a> .hud-filtered-by-type .hud-filtered-by-string style rules belong in content</li>
      <li><a class="bug test patch p3">bug 594741</a> Web Console stress test</li>
      <li><a class="bug test patch p3">bug 605351</a> fix and re-enable browser_webconsole_bug_593003_iframe_wrong_hud.js</li>
      <li><a class="bug test p3">bug 607325</a> Test browser_webconsole_bug_594477_clickable_output.js always fails for me</li>
      <li><a class="bug test p2">bug 609723</a> Assertion in browser_webconsole_bug_597103_deactivateHUDForContext_unfocused_window.js</li>
      <li><a class="bug test p2">bug 609718</a> Assertion in browser_webconsole_chrome.js</li>
      <li><a class="bug test p2">bug 610953</a> hudservice head.js should not declare variables or call waitForFinish</li>
      <li><a class="bug test review p2">bug 605634</a> Opening two Web Consoles on the same URI causes errors (waiting since 10/20 for review)</li>
    </ul>
  </body>
</html>